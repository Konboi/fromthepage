// Check for unsaved settings before changing pages
function unsavedSettings(e) {
    var msg = "You have unsaved changes. Please save or discard your work before leaving this page.";
    var inputs = $('input').add($('textarea')).add($('select'));
    checkForUnsaved(inputs, msg, e);
}

function checkForUnsaved(inputs, msg, e) {
    inputs.each(function() {
        console.log("Checking input " + this.type + " " + this.name + ": " + this.value + " " + this.defaultValue);
        if (this.type == 'radio' || this.type == 'checkbox') {
            if (this.checked != this.defaultChecked) {
                e.preventDefault();
                alert(msg);
                return false;
            }
        } else if (this.type == 'select-one' || this.type == 'select-multiple') {
            if (!(this.options[this.selectedIndex].defaultSelected)) {
                e.preventDefault();
                alert(msg);
                return false;
            }
        } else {
            if (this.value != this.defaultValue) {
                e.preventDefault();
                alert(msg);
                return false;
            };
        }
    });
}

// Check for unsaved changes if user tries to navigate to other tabs
window.addEventListener('DOMContentLoaded', function() {
    var tabs = document.querySelector('div.tabs');
    if (tabs) {
        tabs.addEventListener('click', function(e) {
            unsavedSettings(e)
        });
    }
});

// Check for unsaved changes if user tries to navigate to other settings tabs
window.addEventListener('DOMContentLoaded', function() {
    var tabs = document.querySelector('div.side-tabs');
    if (tabs) {
        tabs.addEventListener('click', function(e) {
            unsavedSettings(e)
        });
    }
});

// Check for unsaved changes if user tries to click on a button that will change the page
window.addEventListener('DOMContentLoaded', function() {
    var buttons = document.querySelectorAll('.button.exits');
    if (buttons) {
        buttons.forEach(function(button) {
            button.addEventListener('click', function(e) {
                unsavedSettings(e)
            });
        });
    }
});